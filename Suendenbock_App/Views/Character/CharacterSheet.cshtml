@using Suendenbock_App.Models.Domain
@model Character
@section Styles {
    <link href="/css/wiki.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&family=Uncial+Antiqua&family=Cinzel:wght@400;600&display=swap" rel="stylesheet">
}

<div class="wiki-container">
    <div class="wiki-header">
        @if (!string.IsNullOrEmpty(Model.ImagePath))
        {
            <img src="@Model.ImagePath" alt="@Model.Vorname @Model.Nachname" class="wiki-avatar">
        }
        else
        {
            <div class="wiki-avatar" style="background: linear-gradient(45deg, #d4af37, #b8941f); display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem;">
                @Model.Vorname.FirstOrDefault()@Model.Nachname.FirstOrDefault()
            </div>
        }

        <div>
            <h1 class="wiki-title">@Model.Vorname @Model.Nachname</h1>
            <p class="wiki-subtitle">
                @Model.Rasse.Name • @Model.Lebensstatus.Name • @Model.Eindruck.Name
            </p>
        </div>
    </div>

    <div class="wiki-content">
        <div class="wiki-main">
            <h3>📜 Charakterbeschreibung</h3>
            <div class="wiki-description">
                @if (!string.IsNullOrEmpty(Model.Details?.Description))
                {
                    @Html.Raw(Model.Details.Description)
                }
                else
                {
                    <em class="text-muted">Keine Beschreibung verfügbar.</em>
                }
            </div>
        </div>

        <div class="wiki-sidebar">
            <div class="wiki-infobox">
                <h4>📊 Charakterdaten</h4>
                <p><strong>Rufname:</strong> @Model.Rufname</p>
                <p><strong>Geschlecht:</strong> @Model.Geschlecht</p>
                @if (!string.IsNullOrEmpty(Model.Geburtsdatum))
                {
                    <p><strong>Geboren:</strong> @Model.Geburtsdatum</p>
                }
                <p>
                    <strong>Magie:</strong>
                    @if (Model.IsUnbegabt)
                    {
                        <div style="margin-left: 10px; margin-top: 5px;">
                            <span class="badge" style="background: linear-gradient(45deg, #666, #888); color: white; font-size: 0.9em;">
                                ⛔ Unbegabt
                            </span>
                            <div style="font-size: 0.85em; color: #999; margin-top: 5px;">
                                <em>Dieser Charakter besitzt keine magischen Fähigkeiten.</em>
                            </div>
                        </div>
                    }
                    else if (Model.CharacterMagicClasses.Any())
                    {
                        <div style="margin-top: 8px;">
                            @foreach (var cmc in Model.CharacterMagicClasses)
                            {
                                <div style="margin-left: 10px; font-size: 0.9em; color: #666; margin-bottom: 8px;">
                                    @(cmc.MagicClass?.Obermagie?.Bezeichnung) → @(cmc.MagicClass?.Bezeichnung)

                                    @if (Model.Profan || Model.Beschraenkt)
                                    {
                                        <span style="color: #999; margin-left: 8px;">
                                            @if (Model.Profan)
                                            {
                                                <span class="badge" style="background: linear-gradient(45deg, #8b4513, #a0522d); color: white; font-size: 0.85em;">
                                                    Profan
                                                </span>
                                            }
                                            else if (Model.Beschraenkt)
                                            {
                                                <span class="badge" style="background: linear-gradient(45deg, #d2691e, #cd853f); color: white; font-size: 0.85em;">
                                                    Beschränkt
                                                </span>
                                            }
                                            <em>(Keine Spezialisierung)</em>
                                        </span>
                                    }
                                    else if (cmc.MagicClassSpecialization != null)
                                    {
                                        <span>→ <strong>@cmc.MagicClassSpecialization.Name</strong></span>
                                    }
                                </div>
                            }
                        </div>
                    }
                    else
                    {
                        <span class="text-muted">Keine Magieklassen zugewiesen</span>
                    }
                </p>
                <p><strong>Beruf:</strong> @Model.Details?.Beruf</p>
                <p><strong>Haus:</strong> @Model.Details?.Haus?.Name</p>
                <p><strong>Herkunft:</strong> @Model.Details?.Herkunftsland?.Name</p>
                <p><strong>Eltern:</strong>
                    <div style="margin-left: 10px; font-size: 0.9em; color: #666;">Vater: @Model.Vater?.Vorname @Model.Vater?.Nachname</div>
                    <div style="margin-left: 10px; font-size: 0.9em; color: #666;">Mutter: @Model.Mutter?.Vorname @Model.Mutter?.Nachname</div>
                </p>
                <p><strong>Blut:</strong> @Model.Details?.Blutgruppe?.Name</p>
                <p><strong>Gilde:</strong> @Model.Affiliation?.Guild?.Name</p>
                <p><strong>Regiment:</strong> @Model.Affiliation?.Regiment?.Name</p>
                <p><strong>Infanterierang:</strong> @Model.Affiliation?.Infanterierang?.Name</p>
            </div>

            
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/character-mentions.js"></script>
}